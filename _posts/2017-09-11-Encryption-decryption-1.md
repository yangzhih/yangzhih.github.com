---
layout: post
title: "
加密解密基本技术——理论浅析"
description: "
加密解密基本技术——理论浅析"
category: articles
tags: [linux,加密，解密]
comments: false
---

## 写在前面

随着计算机网络的发展，网络中的安全问题也日趋严重。当网络的用户处于不同的社会身份时，大量在网络中存储和传输的数据就需要保护。所以如何对数据进行加密就成为了计算机安全领域研究的问题。<br/>
本文只对计算机网络中的加密解密的技术做一个浅析，不详细的研究算法的实现,如果有何错误，敬请指正。

本文主要内容：
+ 对称加密体制和公钥加密体制的特点。
+ 数字签名的的概念
+ CA的搭建

在讲述加密解密之前，笔者很希望读者理解一个概念：**安全**。在密码学中安全分为两种：**无条件安全**和**计算上安全**。<br/>
**无条件安全**：无论数据的截获者获得了多少密文，但是在密文中都没有足够的信息来确认唯一的明文，就说这一种加密体制是无条件安全的，也可以称为理论上不可破译的，在无限制的情况下，目前是密码体制是无条件安全的。<br/>
**计算上安全**：如果一个加密体制中的密码不能再一定的时间内被可以使用的计算资源破译，就称为这种加密体制是计算上安全的，通俗的讲就是在使用当前运算速度最快的计算机在人类有限的生命中是不能破译该密码的情况下就说这个加密体制是无条件安全的。但是随着计算机硬件速度的加快和对破译算法的优化，很多密码体制逐渐变得不安全。

## 数据再网络中的加密传输模型

数据在网络中的加密传输模型如下图所示。用户A想要通过一种安全的方式在互联网中向B发送一个数据X。首先需要把对数据X进行一个加密运算E生成密文Y，然后把密文Y通过互联网传送给用户B，用户B对密文Y进行一个解密运算D就得出了数据A。使用这种传输方式，数据的安全由密钥来决定。就算黑客在网络中获得了发送的数据，没有密钥，也可以认为数据是安全的。

 <img src="http://ot9scj6tc.bkt.clouddn.com/Encryption-decryption.png" />

在这个加密解密过程中，使用了加密密钥K1和解密密钥K2。如果密钥K1和密钥K2是同一把密钥，这种属于对称加密体制。如果K1，K2属于不同的加密密钥(即使不同，两个密钥也有着某一种相关性)属于公钥加密体制。下面简述一下对称加密体制和公钥加密体制的特点。

## 对称加密体制

对称加密体制即加密密钥和解密密钥使用相同的密钥体制。<br/>
对称加密的算法有很多，常见的有DES，3DES，AES，以及一些Blowfish,twofish等。<br/>
DES是数据加密标准，由IBM研制出。<br/>
3DES是基于DES，对同一块数据使用三个不同的密钥进行加密，强度更高。<br/>
AES，高级加密标准，速度快，安全级别高，密钥长度更长。<br/>

**使用对称加密体制加密的数据的保密性取决于密钥的保密，因为算法是公开的。**

### 对称加密体制的优缺点

**优点**：算法公开，计算量小，加密速度快，加密效率高。适用于大量数据的加密。<br/>
**缺点**：

1. 交易双方使用同样的钥匙，安全性无法保证；
2. 当通信对象过多时，两两之间使用他人不知道的密钥造成密钥过多，不易管理；
3. 无法确认数据来源是否可信。

## 公钥加密体制
公钥加密体制使用不同的加密密钥和解密密钥。在公钥加密体制中，加密密钥PK是公开的，每个人都可以获得，解密密钥SK则是保密的，加密算法和解密算法也是公开的。

使用公钥加密体制具有以下特点：
1. 密钥是成对出现的，一个公钥有且只有一个与之对应的私钥。私钥保密，公钥公开。
2. 以上图为例：如果A要给B发送数据，需要使用B的公钥PKb来对明文A进行加密，B得到密文Y后使用自己的私钥SKb进行解密得出明文A
3. 已知私钥可以推出公钥，已知公钥不可推出私钥。私钥到公钥的推导是不可逆的（计算上安全）。
4. 对数据A进行加密运算E然后做解密运算D可得出明文，对其先进行解密运算D再进行加密运算E得出的结果也是明文A。（也是后面数字签名的实现方式）。

### 公钥加密体制的优缺点

**优点**：无需像对称加密一样传输唯一密钥，安全性高
	使用私钥加密可以确认数据来源
**缺点**：速度慢，不适合对大量数据的加密

### 主要用途

**数字签名**：主要在于让接收方确认发送方的身份;用户可以先使用自己的私钥对某个数据加密，接收者只能使用所对应的公钥解密，由此确认数据来源<br/>
**密钥交换**：发送方用对方的公钥加密一个对称密钥，并发送给对方<br/>
**数据加密**：密钥长度过长，加密性能较低（一般不使用）

常用的算法：RSA,DSA,ELGamal


## 单向加密算法

除了对称加密体制和公钥加密体制之外，还需要了解的一个算法是单向加密算法，也称为散列值算法或者摘要算法。该算法就是通过一个单向的数学函数将任意长度的数据转换为一个固定长度的的唯一数字。长度一般在128-512之间。<br/>
散列是数据的提炼，也是可以称为该数据的特征码或者摘要，从数据到摘要的过程是不可逆的。散列加密还有一个特性就是，数据发生微小变化，哪怕只是修改了一位，其摘要信心会有明显的变化。这个特性通常叫做**雪崩效应**。

单向加密算法特性：**定长输出，雪崩效应**
常见算法：

	算法：输出位数
	MD5:128bit
	SHA1:160bit
	SHA224:224bit
	SHA256:256bit
	SHA384:384bit
	SHA512:512bit

**功能**：主要用于检查**数据完整性**

## 组合加密模型

在互联网加密传输过程中使用对称加密体制不够安全，但加密效率快。使用公钥加密体制效率慢，不仅安全又可确认数据来源。使用单向能够确认数据完整性。所以整体考虑就把三种加密体制糅合在一起进行传输。常见的加密模型如图所示。先对明文进行一个单向加密，等到他的一个数据摘要，数据摘要数据量小，使用发送者的私钥对其进行一个解密D运算，接收者只能使用发送者的公钥来去解密，这样确认了数据来源，又可根据得到的摘要信息检查数据完整性。然后把数据摘要信息和明文组合做一个对称加密，来保证明文的安全性，加密效率又快。最后用接受者的公钥把对称加密的钥匙进行加密与数据密文组合发送给接收者。
 <img src="http://ot9scj6tc.bkt.clouddn.com/Encryption-decryption-1.png"  />

## 实践

### 对称加密
以des3算法为例。

	#cat >test.txt <<EOF   先生成一个文件
	> Hello,YangZhiHeng.
	> This is a important data.
	> Please encryption.
	> EOF
	加密 -e选项表示加密  -d表示解密 
	#openssl enc -e -des3 -a -salt -in test.txt -out test.txt.ciphertext   
	enter des-ede3-cbc encryption password:
	Verifying - enter des-ede3-cbc encryption password:
	#cat test.txt.ciphertext  #生成不可读的加密文件
	U2FsdGVkX18DaETpo7hdGGOxexC5KlojOXdRJQXzmRrrxMa1B0gzHIm1q+p1fxnY
	QiZ+BhcHrjV/OFk27VrSzjOaEd1WpeRZb7yivxu29Q2iDsK4eHj7ZA==
	#rm -f test.txt  #删除原文件，保证保密性   
	解密
	#openssl enc -d -des3 -a -salt -in test.txt.ciphertext  #不输出到文件中，解密时需指定原来的加密算法
	enter des-ede3-cbc decryption password:
	Hello,YangZhiHeng.
	This is a important data.
	Please encryption.
	#openssl enc -d -des3 -a -salt -in test.txt.ciphertext -out test.txt  #-out选项指定输出的文件

## 单向加密

	#openssl dgst -md5  -out test.txt.md5 test.txt   #输出至文件 md5可换为其他散列算法比如sha1. 
	#openssl dgst -md5  test.txt   #在标准输出显示 

## 生成公钥私钥对

	#(umask 066;openssl genrsa  -out rsakey.private  2048 –des3 )  #修改权限并对私钥进行加密,圆括号表示开启子进程执行，定义umask不影响当前shell环境
	#openssl rsa  -in rsakey.sk -pubout -out rsakey.pk  从私钥中提取公钥
	
	#openssl genrsa -out rsakey.sk 4096
	#chmod og=- rsakey.sk
	# openssl rsa -in rsakey.sk -pubout > rsakey.pk