---
layout: post
title: "Linux文件管理--特殊权限"
description: "Linux文件管理"
category: articles
tags: [linux, 权限]
comments: false
---

## Linux文件权限之特殊权限
  在讲述特殊权限之前，以一个小例子来引入一下什么特殊权限的作用。<br/>
  众所周知，普通用户对/etc/shadow文件没有读写执行权限，但是当用户对自己口令进行更改的时候shadow文件为什么会发生更改呢，这是因为passwd命令有特殊权限，也就是SUID权限。<br/>
### SUID权限
- 任何一个可执行的二进制文件能不能启动为进程，这取决于发起者对该文件是否有可执行权限
- 进程启动之后，该进程的属主为该文件的所有者，而非文件的发起者。如果把passwd的suid权限去除，用户将不能更改口令。
- SUID权限仅能作用于可执行的二进制的文件，可执行与二进制两个条件缺一不可，作用于其他文件无意义。
	
理解了上述几条之后就容易理解普通用户为何可以更改自己口令了。如下图所示，passwd文件拥有SUID权限，所以当用户执行passwd命令时，用户身份就临时切换成为了root用户。

![](http://ot9scj6tc.bkt.clouddn.com/suid.png)
当文件没有可执行权限时，SUID权限显示为S，这是一种错误的状态，给管理员起到一个警示作用。


### SGID权限

与SUID权限类似，SGID一般也作用于可执行的二进制文件，当用户执行该文件时切换为二进制文件属组的什么来执行。

- 当SGID权限作用于目录时，在该目录下新建的文件默认属于该目录的所在组。

 
![](http://ot9scj6tc.bkt.clouddn.com/sgid.png)

### Sticky

具有写权限的目录通常用户可以删除该目录中的任何文件，无论该文件的权限或拥有权，如果在目录设置Sticky权限，那么只有文件的所有者或root可以删除该文件。

![](http://ot9scj6tc.bkt.clouddn.com/sticky.png)

## Linux文件权限之隐藏权限 

![](http://ot9scj6tc.bkt.clouddn.com/chattr.png)

如上图所示加了某些文件的隐藏属性之后，即使是root用户也无法来对其进行强制操作。<br/>
更改和查看文件隐藏属性的命令时chattr和lsattr。chattr命令可以给文件加上诸多隐藏属性，常用的有一下几个：

	使用方法：chattr [-R] [+-=][iaASsu..] filename
	-R ：递归，对目录及其子文件夹下的所有文件更改隐藏属性

	-i：设置i属性后，该文件不能被删除、改名，设置连接也无法写入或添加更改数据，只有root才能设置这个属性
	-a:设置a之后，这个文件将只能增加数据，而不能删除也不能修改数据，只有root才能设置这个属性。
	-A：设置A后，该文件的atime不会被修改。
	-d：当dump程序被执行的时候，设置d属性将可使该文件（或目录）不会被dump备份	
	-s：设置了s属性时，如果这个文件被删除，它将会被完全从这个硬盘空间中删除。
	-u：与s相反，当文件设置u属性后，如果该文件被删除了，则数据内容其实还存在磁盘中。
	-c ：设置c属性后，系统会自动将此文件压缩，在读取的时候会自动解压缩，但是在存储的时候，将会先进行压缩后再存储。

	lsattr [-adR] filename

	-a ：将隐藏文件的隐藏属性也显示出来
	-d ：如果接的是目录，仅列出目录本身的属性而非目录内的文件名
	-R ：连同子目录的数据也一并列出

