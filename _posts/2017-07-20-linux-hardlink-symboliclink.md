---
layout: post
title: "硬链接与软连接"
description: "硬链接与软连接"
category: articles
tags: [linux, 软连接，硬链接]
comments: false
---

Linux系统中存在两种链接文件，硬链接（hard link）和符号链接（symbolic link）。符号链接也称为软连接。想了解清楚这两种链接文件的区别并不容易，首先要清楚Linux文件系统的相关知识。
我们知道文件有文件名和数据。而Linux的文件系统在存储文件时分为两个部分，用户数据（userdata）和元数据（metadata）。用户数据是文件的真实数据存储文件系统的data block中，元数据存储在一个iNode的节点块中，包括文件的iNode号，权限，大小，时间属性（atime,ctime,mtime），所属者/组等属性信息（但并不包括文件名）。
## iNode
对于文件系统来讲，iNode（index node）才是文件的唯一标识，并非文件名，文件名只是符合人类记忆习惯而实现的一种方式。这样就可用下图来说明计算机是如何通过文件名来访问的文件的了。
  
![](http://ot9scj6tc.bkt.clouddn.com/001.jpg)


在Linux操作系统中，可以使用stat或者ls -i命令查看文件的iNode号,使用df  –i 命令查看整个文件系统的iNode节点使用情况。笔者说过，iNode号相对于文件系统来具有唯一性，对于不使用raid或者lvm技术的传统文件系统的来说就是在“分区”内iNode是文件访问的唯一标识。

为了解决文件共享的问题（笔者自认为），Linux在文件系统设计上支持链接文件。分为硬链接和符号链接。
## 硬链接
当iNode号具有多个文件名的时候，称这种文件为硬链接文件，硬链接文件和源文件在系统下具有相同的“地位”。为了更直观的理解，我引用了鸟哥私房菜书中的插图。

![](http://ot9scj6tc.bkt.clouddn.com/hardlink.jpg)

由于硬链接的元数据与源文件的完全一致（就是同一条元数据），所以有了它的一系列特性。

1，	不能跨文件系统；

2，	有相同的iNode和data block； 

3，	硬链接只能对已经存在的文件进行创建；

4，	不能针对目录文件进行创建，Linux文件系统在设计时对目录默认创建了两个硬链接， .  ..  如果再支持目录创建硬链接的话会生成目录环可能会造成死锁（笔者一家之言）；

5，	删除文件时，必须删除所有的硬链接才能真正释放data block.


## 软连接

与硬链接不同，软连接是一个独立的文件，与源文件的元数据和用户数据都不同。软连接的的数据块中存储的只是指向源文件的路径。当然这里也这里也引用鸟哥图来让读者直观的理解。

![](http://ot9scj6tc.bkt.clouddn.com/symboliclink.jpg)

相比于硬链接来说，我认为软连接打破了他的诸多限制。

1，	软连接有自己的元数据，所以可以对其进行权限控制

2，	可跨越文件系统（包括网络）创建软连接

3，	可对不存在的文件和目录创建（打破不能链接目录的限制）

4，	创建软连接，源文件链接数不增加

5，	删除软连接时不影响源文件



##　验证硬链接的特性